<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Pumpkin Plot</title>
    <meta name="description" content="Inspired by the Digital Arts with MATLAB project, I wanted to check out if the Racket 3D Plot package could be used for a similar purpose, so I decided to plot a pumpkin...">
    <meta name="author"      content="Alex Harsányi">
    <meta name="keywords"    content="racket, data visualization">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="/img/favicon.svg">
    <link rel="canonical" href="https://alex-hhh.github.io/2022/10/pumpkin-plot.html">
    <link rel="next" href="/2022/09/wolf-goat-cabbage.html">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Mono&display=swap" rel="stylesheet">
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml"
          href="/feeds/all.atom.xml" title="Atom Feed">
    <link rel="alternate" type="application/rss+xml"
          href="/feeds/all.rss.xml" title="RSS Feed">
    <!-- JS -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110325732-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-110325732-1');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
      <div class="container">
        <a href="/index.html" class="navbar-brand">Alex Harsányi</a>

        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbar_collapse" aria-controls="navbar_collapse"
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbar_collapse">
          <ul class="navbar-nav mr-auto">

            <li class="nav-item dropdown">
              <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
                Tags <b class="caret"></b></a>
              <ul class="dropdown-menu" role="menu" id="tags-menu-content">
                <!-- will be filled in dynamically by custom.js -->
              </ul>
            </li>
            <li>
              <a class="nav-link" href="/About.html">About</a>
            </li> 
            <li>
              <a class="nav-link" href="/tags/arduino.html">Arduino</a>
            </li> 
            <li>
              <a class="nav-link" href="/tags/racket.html">Racket</a>
            </li> 
            <li>
              <a class="nav-link" href="/tags/activitylog2.html">ActivityLog2</a>
            </li> 
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row">

        <!-- Main column -->
        <!-- NOTE: there is a bug in the web server template renderer which
             indents all items inside if blocks.  This means that we cannot
             put the contents inside an if block, as all the <pre> tags will
             be indented.
          -->
        <div id="content" class=col-md-9>





          <article>
  <header>
    <h1>Pumpkin Plot</h1>
    <p class='date-and-tags'>
<time datetime="2022-10-16" pubdate="true">2022-10-16</time> :: <span class="tags"><a href="/tags/racket.html">racket</a>, <a href="/tags/data-visualization.html">data visualization</a></span></p>
  </header>

<p>Inspired by the <a href="https://github.com/zappo2/digital-art-with-matlab">Digital Arts with MATLAB</a> project, I wanted to check out if the <a href="https://docs.racket-lang.org/plot/index.html">Racket 3D Plot</a> package could be used for a similar purpose, so I decided to plot a pumpkin&hellip;</p>
<!-- more-->

<p>&hellip; and here is the result:</p>

<div class="figure"><img src="/img/a057/screenshot.png" alt="" />
 <p class="caption"></p></div>

<p>This blog post will show a step-by-step guide on how this plot was build, but, before we begin, let&rsquo;s load the required libraries: we&rsquo;ll use the <a href="https://docs.racket-lang.org/plot/index.html">plot</a> library for plotting and the <a href="https://docs.racket-lang.org/pict/index.html">pict</a> library for adding some nice labels to the plots:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))" style="color: inherit">require</a></span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">pict</span><span class="p">)</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>There are also a few plot parameters that are useful for this project, these parameters control how the plot looks: how many samples to use for 3D rendering, the width and height of the plot, as well as clearing the labels on the X, Y and Z axes:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="c1">;; open plots in a separate window instead of the REPL</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-new-window?</span><span class="w"> </span><span class="no">#f</span><span class="p">)</span><span class="w"></span>
<span class="c1">;; Number of samples for 3D plots </span><span class="w"></span>
<span class="c1">;; higher values look better, but slower rendering</span><span class="w"></span>
<span class="p">(</span><span class="n">plot3d-samples</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span><span class="w"></span>
<span class="c1">;; The width and height (in pixels) of the plot</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-width</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-height</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w"></span>
<span class="c1">;; Clear the labels of the X, Y and Z axes</span><span class="w"></span>
<span class="c1">;; since they are not meaningfull for a pumpkin</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-x-label</span><span class="w"> </span><span class="no">#f</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-y-label</span><span class="w"> </span><span class="no">#f</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="n">plot-z-label</span><span class="w"> </span><span class="no">#f</span><span class="p">)</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<h2 id="a-sphere">A Sphere</h2>

<p>We begin by plotting a sphere, and the simplest way to do that in the racket plot package is to use the <a href="https://docs.racket-lang.org/plot/renderer3d.html#%28def._%28%28lib._plot%2Fmain..rkt%29._polar3d%29%29">polar3d</a> renderer, which plots a function that maps from a Latitude/Longitude pair to a a radius value. Given that we are plotting a sphere, the radius will be a constant:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; the radius of the sphere</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">sphere</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"> </span><span class="n">pumpkin-size</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-color</span><span class="w"> </span><span class="s2">"brown"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-width</span><span class="w"> </span><span class="mf">0.2</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">solid</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>If you try to display the sphere in the DrRacket REPL, you&rsquo;ll notice that it does not display anything useful, this is because <code>sphere</code> is just a &ldquo;renderer&rdquo;, an object that needs to be passed to one of the plot functions for rendering.</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3e))" style="color: inherit">&gt;</a></span><span class="w"> </span><span class="n">sphere</span><span class="w"></span>
<span class="p">(</span><span class="n">renderer3d</span><span class="w"></span>
<span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/vectors.html#(def._((quote._~23~25kernel)._vector))" style="color: inherit">vector</a></span><span class="w"> </span><span class="p">(</span><span class="n">ivl</span><span class="w"> </span><span class="mf">-0.9997495328765437</span><span class="w"> </span><span class="mf">0.9998741276738751</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ivl</span><span class="w"> </span><span class="mf">-0.9998429784893453</span><span class="w"> </span><span class="mf">0.9998429784893453</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ivl</span><span class="w"> </span><span class="mf">-1.0</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span><span class="w"></span>
<span class="w"> </span><span class="no">#f</span><span class="w"></span>
<span class="w"> </span><span class="n">#&lt;procedure:default-ticks-fun&gt;</span><span class="w"></span>
<span class="w"> </span><span class="no">#f</span><span class="w"></span>
<span class="w"> </span><span class="n">#&lt;procedure:...ot3d/isosurface.rkt:216:0&gt;</span><span class="p">)</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>To plot the sphere, we simply pass the sphere to the <a href="https://docs.racket-lang.org/plot/plotting.html#%28def._%28%28lib._plot%2Fmain..rkt%29._plot3d%29%29">plot3d</a> function, using <code>(plot3d sphere)</code>, and if you run the code in the DrRacket REPL, you can rotate the plot interactively with the mouse:</p>

<div class="figure"><img src="/img/a057/sphere-plot.png" alt="" />
 <p class="caption"></p></div>

<h2 id="squashing-it">Squashing It</h2>

<p>The next step is to &ldquo;squash&rdquo; this sphere into a more &ldquo;pumpkin-like shape&rdquo; and we&rsquo;ll use the function sin⁴(x) to reduce the radius of the sphere depending on the &ldquo;latitude&rdquo;. Before we build the 3D plot, it might be useful to plot the squashing function separately:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">squash-depth</span><span class="w"> </span><span class="mf">0.4</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="p">(</span><span class="n">squash</span><span class="w"> </span><span class="n">latitude</span><span class="w"> </span><span class="p">[</span><span class="n">depth</span><span class="w"> </span><span class="n">squash-depth</span><span class="p">])</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._expt))" style="color: inherit">expt</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sin))" style="color: inherit">sin</a></span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">depth</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>We can plot this function on a 2D plane using the <a href="https://docs.racket-lang.org/plot/renderer2d.html#%28def._%28%28lib._plot%2Fmain..rkt%29._polar%29%29">polar</a> renderer, this time we&rsquo;ll construct and pass the renderer directly to the <a href="https://docs.racket-lang.org/plot/index.html">plot</a> function.</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="n">plot</span><span class="w"></span>
<span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"> </span><span class="p">(</span><span class="n">squash</span><span class="w"> </span><span class="n">latitude</span><span class="p">)))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:width</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">point-pict</span><span class="w"></span>
<span class="w">   </span><span class="o">#</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="n">vc-append</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="s2">"Squash"</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" style="color: inherit">format</a></span><span class="w"> </span><span class="s2">"depth <a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" style="color: inherit">=</a> ~a"</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((lib._racket/format..rkt)._~7er))" style="color: inherit">~r</a></span><span class="w"> </span><span class="n">squash-depth</span><span class="w"> </span><span class="kd">#:precision</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:anchor</span><span class="w"> </span><span class="o">'</span><span class="ss">center</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:point-sym</span><span class="w"> </span><span class="o">'</span><span class="ss">none</span><span class="p">))</span><span class="w"></span>
<span class="w"> </span><span class="kd">#:x-min</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="kd">#:x-max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kd">#:y-min</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="kd">#:y-max</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/squash-outline.png" alt="" />
 <p class="caption"></p></div>

<p>We can define the &ldquo;squashed sphere&rdquo; renderer by simply subtracting the value of the <code>squash</code> function from the radius:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">squashed-sphere</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"> </span><span class="p">(</span><span class="n">squash</span><span class="w"> </span><span class="n">latitude</span><span class="p">)))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-color</span><span class="w"> </span><span class="s2">"brown"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-width</span><span class="w"> </span><span class="mf">0.2</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">solid</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>&hellip; and we can inspect the result using <code>(plot3d squashed-sphere)</code>, and rotate the plot in the DrRacket REPL:</p>

<div class="figure"><img src="/img/a057/squashed-sphere.png" alt="" />
 <p class="caption"></p></div>

<h2 id="adding-bumps">Adding Bumps</h2>

<p>A pumpkin should have bumps, and these will be done using a function that modifies the sphere radius along the longitudinal axis. As with the squash function, it is simpler to first visualize the bumps as a 2D plot. We&rsquo;ll interleave two bumps around the sphere, a &ldquo;deeper&rdquo; and a &ldquo;shallower&rdquo; one:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">num-bumps</span><span class="w"> </span><span class="mf">7.0</span><span class="p">)</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="p">(</span><span class="n">fmod</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._exact-truncate))" style="color: inherit">exact-truncate</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">bangle</span><span class="w"> </span><span class="n">bdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._expt))" style="color: inherit">expt</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="p">(</span><span class="n">fmod</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">bangle</span><span class="p">)</span><span class="w"> </span><span class="n">bangle</span><span class="p">)</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="n">bdepth</span><span class="p">))</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">primary-bump-depth</span><span class="w"> </span><span class="mf">0.25</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">primary-bump-angle</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">num-bumps</span><span class="p">)))</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">secondary-bump-depth</span><span class="w"> </span><span class="mf">0.07</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">secondary-bump-angle</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">num-bumps</span><span class="p">)))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>And we can plot the bumps outline to adjust the parameters:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="n">plot</span><span class="w"></span>
<span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">primary-bump-angle</span><span class="w"> </span><span class="n">primary-bump-depth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">secondary-bump-angle</span><span class="w"> </span><span class="n">secondary-bump-depth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:width</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">point-pict</span><span class="w"></span>
<span class="w">   </span><span class="o">#</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="n">vc-append</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="s2">"Bumps"</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" style="color: inherit">format</a></span><span class="w"> </span><span class="s2">"count <a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" style="color: inherit">=</a> ~a"</span><span class="w"> </span><span class="n">num-bumps</span><span class="p">)</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" style="color: inherit">format</a></span><span class="w"> </span><span class="s2">"primary depth <a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" style="color: inherit">=</a> ~a"</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((lib._racket/format..rkt)._~7er))" style="color: inherit">~r</a></span><span class="w"> </span><span class="n">primary-bump-depth</span><span class="w"> </span><span class="kd">#:precision</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/Writing.html#(def._((quote._~23~25kernel)._format))" style="color: inherit">format</a></span><span class="w"> </span><span class="s2">"secondary depth <a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3d))" style="color: inherit">=</a> ~a"</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((lib._racket/format..rkt)._~7er))" style="color: inherit">~r</a></span><span class="w"> </span><span class="n">secondary-bump-depth</span><span class="w"> </span><span class="kd">#:precision</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">'</span><span class="ss">default</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:anchor</span><span class="w"> </span><span class="o">'</span><span class="ss">center</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:point-sym</span><span class="w"> </span><span class="o">'</span><span class="ss">none</span><span class="p">))</span><span class="w"></span>
<span class="w"> </span><span class="kd">#:x-min</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="kd">#:x-max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kd">#:y-min</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="kd">#:y-max</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/bumps-outline.png" alt="" />
 <p class="caption"></p></div>

<p>As with squashing, we can define a &ldquo;sphere with bumps&rdquo; by subtracting the value of the <code>bump</code> function (one for the primary and one for the secondary bump) from the sphere radius, and plotting it using <code>(plot3d
sphere-with-bumps)</code>:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">sphere-with-bumps</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">primary-bump-angle</span><span class="w"> </span><span class="n">primary-bump-depth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">secondary-bump-angle</span><span class="w"> </span><span class="n">secondary-bump-depth</span><span class="p">)))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-color</span><span class="w"> </span><span class="s2">"brown"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-width</span><span class="w"> </span><span class="mf">0.2</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">solid</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/sphere-with-bumps.png" alt="" />
 <p class="caption"></p></div>

<h2 id="the-pumpkin">The Pumpkin</h2>

<p>The <code>squash</code> and <code>bump</code> functions can be combined together, both squasing the sphere and applying bumps to it, making it look like a pumpkin, and plot it using <code>(plot3d the-pumpkin)</code>:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">the-pumpkin</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">polar3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="n">pumpkin-size</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">squash</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">primary-bump-angle</span><span class="w"> </span><span class="n">primary-bump-depth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">secondary-bump-angle</span><span class="w"> </span><span class="n">secondary-bump-depth</span><span class="p">)))</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"darkorange"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">transparent</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/pumpkin-no-stem.png" alt="" />
 <p class="caption"></p></div>

<h2 id="a-cylinder">A Cylinder</h2>

<p>To make a credible pumpkin, we&rsquo;ll need a stem, and to plot that, we&rsquo;ll start with a cylinder. To render a cylinder, we can use the <a href="https://docs.racket-lang.org/plot/renderer3d.html#%28def._%28%28lib._plot%2Fmain..rkt%29._parametric-surface3d%29%29">parametric-surface3d</a> renderer &mdash; this is a generalization of the <code>polar3d</code> renderer: it still takes a function of two arguments, but allows specifying the range for each of the arguments. In our case, we&rsquo;ll use the first parameter to specify the &ldquo;longitude&rdquo; with a range of 0..2π and another parameter to specify the height of the cylinder, ranging from 0 to 1, this will actually be a percentage of the actual cylinder height, which is defined as <code>stem-length</code> below.</p>

<p>The parametric surface function accepts the two parameters and returns a 3D position, as a list X, Y and Z values. Finally, all the Z values are offset by <code>stem-z</code>, so the cylinder is not drawn at the origin, but at the top of our pumpkin.</p>

<p>The cylinder plotted below is already scaled to match the pumpkin size, but if you find this confusing, it might be worth setting the <code>stem-length</code> to 1, <code>stem-radius</code> to 0.5 and <code>stem-z</code> to 0, so see that this really is a cylinder:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-length</span><span class="w"> </span><span class="mf">0.35</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-radius</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-z</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="n">squash-depth</span><span class="p">))</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">cylinder</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">parametric-surface3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="n">stem-radius</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sin))" style="color: inherit">sin</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w">     </span><span class="c1">; X</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._cos))" style="color: inherit">cos</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w">     </span><span class="c1">; Y</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="n">stem-z</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">stem-length</span><span class="p">))))</span><span class="w"> </span><span class="c1">; Z</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w">                           </span><span class="c1">; longitude range</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w">                                  </span><span class="c1">; t range</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"forestgreen"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">transparent</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>Here is what it looks like when plotted using <code>(plot3d cylinder)</code>, this looks better in the DrRacket REPL, where the plot can be rotated:</p>

<div class="figure"><img src="/img/a057/cylinder-plot.png" alt="" />
 <p class="caption"></p></div>

<h2 id="narrowing">Narrowing</h2>

<p>The pumpkin stem needs to narrow as it approaches the top, and we can do that by reducing the cylinder radius based on its height. There are several ways to do that, but I found the function below to work nicely, although it took a few tries to tune the parameters:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-narrowing</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="p">(</span><span class="n">narrow-stem</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">stem-narrowing</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._log))" style="color: inherit">log</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="mi">10</span><span class="p">)))</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._log))" style="color: inherit">log</a></span><span class="w"> </span><span class="mi">11</span><span class="p">)))))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>Here is the parametric plot which narrows the cylinder, making it resemble a stem, it can be plotted using <code>(plot3d cylinder-with-narrow-top)</code>:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">cylinder-with-narrow-top</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">parametric-surface3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">radius</span><span class="w"></span>
<span class="w">       </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">stem-radius</span><span class="w"> </span><span class="p">(</span><span class="n">narrow-stem</span><span class="w"> </span><span class="n">t</span><span class="p">)))</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sin))" style="color: inherit">sin</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w">     </span><span class="c1">; X</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._cos))" style="color: inherit">cos</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w">     </span><span class="c1">; Y</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="n">stem-z</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">stem-length</span><span class="p">))))</span><span class="w"> </span><span class="c1">; Z</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w">                           </span><span class="c1">; longitude range</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w">                                  </span><span class="c1">; t range</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"forestgreen"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">transparent</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/cylinder-with-narrow-top.png" alt="" />
 <p class="caption"></p></div>

<h2 id="bending">Bending</h2>

<p>The stem on a pumpkin is also bent to one side, so we&rsquo;ll need to bend the cylinder by adjusting the X, Y coordinates of the parametric function. As with narrowing, there are several functions that can be used, but I found the one below, based on logarithms to produce nice results:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-bending</span><span class="w"> </span><span class="mf">0.15</span><span class="p">)</span><span class="w"></span>
<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="p">(</span><span class="n">bend</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" style="color: inherit">/</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._log))" style="color: inherit">log</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="mi">10</span><span class="p">)))</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._log))" style="color: inherit">log</a></span><span class="w"> </span><span class="mi">11</span><span class="p">))</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">stem-bending</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>We can apply only the bending to the cylinder, to see how it looks, note that we adjust both the X, and Y arguments by the same value, but this is not necessary:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">cylinder-with-bending</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">parametric-surface3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="n">stem-radius</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">bending</span><span class="w"> </span><span class="p">(</span><span class="n">bend</span><span class="w"> </span><span class="n">t</span><span class="p">))</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sin))" style="color: inherit">sin</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="n">bending</span><span class="p">)</span><span class="w"> </span><span class="c1">; X</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._cos))" style="color: inherit">cos</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="n">bending</span><span class="p">)</span><span class="w"> </span><span class="c1">; Y</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="n">stem-z</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">stem-length</span><span class="p">))))</span><span class="w">         </span><span class="c1">; Z</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w">                                     </span><span class="c1">; longitude range</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w">                                            </span><span class="c1">; t range</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"forestgreen"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">transparent</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>Here is the output from <code>(plot3d cylinder-with-bending)</code>:</p>

<div class="figure"><img src="/img/a057/cylinder-with-bending.png" alt="" />
 <p class="caption"></p></div>

<h2 id="the-stem">The Stem</h2>

<p>To build the actual stem, we&rsquo;ll start with the cylinder, then we&rsquo;ll apply the narrowing and bending to it. To make it more realistic, we can also add bumps to it, using the same <code>bump</code> function we used for the pumpkin, the bump value is applied to the stem radius after narrowing it:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">stem-bump-depth</span><span class="w"> </span><span class="mf">0.01</span><span class="p">)</span><span class="w"></span>

<span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">the-stem</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">parametric-surface3d</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" style="color: inherit">lambda</a></span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">radius</span><span class="w"></span>
<span class="w">       </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">stem-radius</span><span class="w"> </span><span class="p">(</span><span class="n">narrow-stem</span><span class="w"> </span><span class="n">t</span><span class="p">))</span><span class="w"></span>
<span class="w">          </span><span class="p">(</span><span class="n">bump</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="n">primary-bump-angle</span><span class="w"> </span><span class="n">stem-bump-depth</span><span class="p">)))</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))" style="color: inherit">define</a></span><span class="w"> </span><span class="n">bending</span><span class="w"> </span><span class="p">(</span><span class="n">bend</span><span class="w"> </span><span class="n">t</span><span class="p">))</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._sin))" style="color: inherit">sin</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="n">bending</span><span class="p">)</span><span class="w"> </span><span class="c1">; X</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" style="color: inherit">-</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._cos))" style="color: inherit">cos</a></span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="n">bending</span><span class="p">)</span><span class="w"> </span><span class="c1">; Y</span><span class="w"></span>
<span class="w">           </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" style="color: inherit">+</a></span><span class="w"> </span><span class="n">stem-z</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">stem-length</span><span class="p">))))</span><span class="w">         </span><span class="c1">; Z</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))" style="color: inherit">*</a></span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((lib._racket/math..rkt)._pi))" style="color: inherit">pi</a></span><span class="p">)</span><span class="w">                                     </span><span class="c1">; longitude range</span><span class="w"></span>
<span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w">                                            </span><span class="c1">; t range</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:color</span><span class="w"> </span><span class="s2">"forestgreen"</span><span class="w"></span>
<span class="w">   </span><span class="kd">#:line-style</span><span class="w"> </span><span class="o">'</span><span class="ss">transparent</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<p>Here is the output from <code>(plot3d cylinder-with-bending)</code>:</p>

<div class="figure"><img src="/img/a057/only-the-stem.png" alt="" />
 <p class="caption"></p></div>

<h2 id="everything-together">Everything Together</h2>

<p>To produce the final pumpkin, we can plot the pumpkin and stem renderers on a single canvas by passing both of them to the <code>plot3d</code> command. The <code>plot3d</code> accepts not only a single renderer but also a list (and a list of lists) of renders, making it easy to combine different elements to be plotted:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="n">plot3d</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="n">the-pumpkin</span><span class="w"> </span><span class="n">the-stem</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>

<div class="figure"><img src="/img/a057/the-pumpkin.png" alt="" />
 <p class="caption"></p></div>

<p>In an interactive DrRacket REPL window, the plot can be rotated using the mouse. Also, the <code>plot3d-samples</code> controls the number of samples used to construct the plot and a low value of 50 will produce a plot where individual faces are noticeable, a higher value (the plot above is rendered using 200 samples) will produce nicer results, but rendering will be slower. Higher sampling values can be used for plots that are saved to image files, for example:</p>

<div class="brush: racket">
 <div class="source">
  <table class="sourcetable">
   <tbody>
    <tr>
     <td class="linenos">
      <div class="linenodiv">
       <pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td>
     <td class="code">
      <div>
       <pre><span></span><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/parameters.html#(form._((lib._racket/private/more-scheme..rkt)._parameterize))" style="color: inherit">parameterize</a></span><span class="w"> </span><span class="p">([</span><span class="n">plot3d-samples</span><span class="w"> </span><span class="mi">200</span><span class="p">])</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">plot3d-file</span><span class="w"> </span><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" style="color: inherit">list</a></span><span class="w"> </span><span class="n">the-pumpkin</span><span class="w"> </span><span class="n">the-stem</span><span class="p">)</span><span class="w"> </span><span class="s2">"the-pumpkin.png"</span><span class="p">))</span><span class="w"></span>
</pre></div></td></tr></tbody></table></div>

</div>
  <footer>
    <div class="fine-print">© Alex Harsányi, licensed under
      <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
      , and there's a <a href="/Cookies.html">cookie policy</a>.
    </div>
    <div class="row justify-content-center">
      <nav aria-label="Page Navigation">
        <ul class="pagination">
          <li class="page-item">
            <a class="page-link" href="/2022/09/wolf-goat-cabbage.html"
               aria-label="Previous">
              <span aria-hidden="true">&larr; The Wolf, the Goat, and the Cabbage</span>
            </a>
          </li>

        </ul>
      </nav>
    </div>
  </footer>
</article>
        </div>
        <div id="sidebar-content" class="col-md-3">
          <!-- will be filled in dynamically by custom.js -->
        </div>

      </div>

    </div>
    <!-- </body> JS -->
  <!-- NOTE: jQuery must be loaded first -->
  <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
  <script type="text/javascript" src="/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="/js/custom.js"></script>
  </body>
</html>